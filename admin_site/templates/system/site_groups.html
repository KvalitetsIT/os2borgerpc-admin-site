{% extends "site_with_navigation.html" %}

{% block specific_title %}
Grupper
{% endblock %}

{% block head_javascripts %}
  <!--
  <script type="text/javascript">
    $(document).ready(function() {
      $('.accordion-group:first-child').find('i').toggleClass('icon-chevron-up icon-chevron-down');
      $('.accordion-toggle').click(function(event){
        $(this).find('i').toggleClass('icon-chevron-up icon-chevron-down');
        $('.accordion-group').each(function() {
          if ($(this).find('.accordion-body').hasClass('in')) {
            $(this).find('i').removeClass('icon-chevron-up').addClass('icon-chevron-down');
          };
        });
      });
    });
  </script>
  -->
{% endblock %}

{% block specific_documentation_links %}
    <li {% block admin_groups_active %}{% endblock %}><a href="{% url 'doc' 'admin_groups' %}"><i class="icon-list-alt icon-white"></i> Administration af grupper</a></li>
{% endblock %}

{% block javascripts %}
<script type="text/javascript" src="/media/js/package_lists.js"></script>
<script type="text/javascript" src="/media/js/configlist.js"></script>
<script type="text/javascript" src="/media/js/pclist.js"></script>
{% endblock %}

{% block groups_active %}
class="active"
{% endblock %}

{% block specific_content %}
  <ul class="sublevelnav">
      <li class="listutils">
        <a href="#addNewGroup" role="button" data-toggle="modal" title="tilføj ny gruppe"><i class="icon-plus icon-white"></i> tilføj ny gruppe</a>
      </li>
      {% for group in site.groups.all %}
      <li {% ifequal group selected_group %}class="active"{% endifequal %}><a
          href="/site/{{ site.url }}/groups/{{ group.url }}/"><i class="icon-tags"></i> {{ group.name }}</a></li>
      {% endfor %}
  </ul>
  
  <div class="container-fluid main sublevelmain">
    
    <h2 class="divideheader">Detaljer om <em>{{ selected_group.name }}</em></h2>
    {% include 'notification.html' %}
    
    <form name="updategroupform" id="updategroupform"
      action="{% url 'group' site.uid selected_group.url %}"
      method="post" class="row-fluid">
    
      <button class="btn btn-primary">Gem ændringer</button>
      <button class="btn" onclick="return BibOS.PackageList.cancelEditing()">Annuller</button>
      {% if selected_group.is_delete_allowed %}
      <br />
      <a  href="/site/{{ site.url }}/groups/{{ selected_group.url }}/delete/">Slet Gruppe</a>
      {% endif %}
      <div class="accordion" id="accordion2">
        
        <div class="accordion-group">
          <div class="accordion-heading">
            <a class="accordion-toggle btn" data-toggle="collapse" data-parent="#accordion2" href="#collapseOne">
              Detaljer <i class="icon-chevron-down pull-right"></i>
            </a>
          </div>
          <div id="collapseOne" class="accordion-body collapse in">
            <div class="accordion-inner">
              <div class="row-fluid">
                <fieldset class="span6">
                  {% csrf_token %}
                  <label for="id_name">Navn:</label>
                  {{ form.name.errors }}
                  {{ form.name }}

                  <label for="id_uid">Id:</label>
                  {{ form.uid.errors }}
                  {{ form.uid }}

                  <label for="id_description">Beskrivelse:</label>
                  {{ form.description.errors }}
                  {{ form.description }}
                </fieldset>
                <fieldset class="span6">
                  <label for="id_pcs">Computere i denne gruppe:</label>
                  {{ form.pcs.errors }}
                  {% include 'system/pclist/list.html' with submit_name='pcs' %}
                </fieldset>
              </div>
            </div>
          </div>
        </div>
        
        <div class="accordion-group">
          <div class="accordion-heading">
            <a class="accordion-toggle btn" data-toggle="collapse" data-parent="#accordion2" href="#collapseTwo">
              Konfigurationer <i class="icon-chevron-down pull-right"></i>
            </a>
          </div>
          <div id="collapseTwo" class="accordion-body collapse">
            <div class="accordion-inner">
              {% include 'system/configlist/list.html' with entries=selected_group.configuration.entries.all cnf_id='group_configuration' %}
            </div>
          </div>
        </div>
        <div class="accordion-group">
          <div class="accordion-heading">
            <a class="accordion-toggle btn" data-toggle="collapse" data-parent="#accordion2" href="#collapseThree">
              Pakker <i class="icon-chevron-down pull-right"></i>
            </a>
          </div>
          <div id="collapseThree" class="accordion-body collapse">
            <div class="accordion-inner">
              {% include 'system/package_lists/list.html' with packages=package_infos pl_id='group_packages'%}
            </div>
          </div>
        </div>
        
      </div>
      
    </form>

    <div id="addNewGroup" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
      <form action="{% url 'new_group' site.uid %}" name="new_group_form" id="new_group_form" method="post">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">×</button>
          <h3>Tilføj ny gruppe</h3>
        </div>
        <div class="modal-body">
            {% csrf_token %}
            {{ newform.as_p }}
        </div>
        <div class="modal-footer">
          <input type="submit" class="btn btn-primary" value="Gem" />
          <input type="reset" class="btn" data-dismiss="modal" value="Annuller" />
        </div>
      </form>
    </div>

    {% include 'system/package_lists/templates.html' %}
    {% include 'system/configlist/templates.html' %}

  </div>
{% endblock %}
