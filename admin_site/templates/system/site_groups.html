{% extends "site_with_navigation.html" %}

{% block specific_title %}
Grupper
{% endblock %}

{% block specific_documentation_links %}
    <li><a href="{% url 'doc' 'groups' %}"><i class="icon-question-sign icon-white"></i> Administration af grupper</a></li>
{% endblock %}

{% block javascripts %}
<script type="text/javascript" src="/static/js/configlist.js"></script>
<script type="text/javascript" src="/static/js/pclist.js"></script>
<script type="text/javascript" src="/static/js/policy_list.js"></script>
{% endblock %}

{% block groups_active %}
class="active"
{% endblock %}

{% block specific_content %}
  <ul class="sublevelnav">
      <li class="listutils">
        <button class="btn btn-link" type="button" data-bs-toggle="modal" data-bs-target="#addNewGroup">
          <i class="icon-plus icon-white"></i> Tilføj ny gruppe
        </button>
      </li>
      {% for group in site.groups.all %}
        <li {% ifequal group selected_group %}class="active"{% endifequal %}>
          {% ifequal group selected_group %}
            {% if selected_group.is_delete_allowed %}
            <a class="float-end btn btn-close btn-danger" href="/site/{{ site.url }}/groups/{{ selected_group.url }}/delete/" title="Slet gruppe"></a>
            {% endif %}
          {% endifequal %}
          <a class="list-item" href="/site/{{ site.url }}/groups/{{ group.url }}/"><i class="icon-tags"></i> {{ group.name }}</a>
        </li>
      {% endfor %}
  </ul>

  <div class="container-fluid main sublevelmain">

    <h2 class="divideheader">Detaljer om <em>{{ selected_group.name }}</em></h2>
    {% include 'notification.html' %}

    <form name="updategroupform" id="updategroupform"
      action="{% url 'group' site.uid selected_group.url %}"
      method="post" enctype="multipart/form-data" class="row-fluid">

      <button class="btn btn-primary">Gem ændringer</button>
      <!--<button class="btn" onclick="return BibOS.PackageList.cancelEditing()">Annuller</button>-->

      <!-- The three tabs on the page: -->
      <ul class="nav nav-tabs" role="tablist">
        <li class="nav-item" role="presentation">
          <a class="nav-link active" id="details-tab" href="#details" data-bs-toggle="tab" role="tab" aria-controls="details" aria-selected="true">Detaljer</a>
        </li>
        <li class="nav-item" role="presentation">
          <a class="nav-link" id="configs-tab" href="#configs" data-bs-toggle="tab" role="tab" aria-controls="configs" aria-selected="false">Konfigurationer</a>
        </li>
        <li class="nav-item" role="presentation">
          <a class="nav-link" id="policies-tab" href="#policies" data-bs-toggle="tab" role="tab" aria-controls="policies" aria-selected="false">Scripts</a>
      </ul>

      <!-- The content for the three tabs you can choose from above, one after one: -->
      <div class="tab-content">

        <div id="details" class="tabcontent tab-pane fade show active" role="tabpanel" aria-labelledby="details-tab">
          <div class="row-fluid">
            <fieldset class="span6">
              {% csrf_token %}
              <label for="id_name">Navn:</label>
              {{ form.name.errors }}
              {{ form.name }}

              <label for="id_uid">Id:</label>
              {{ form.uid.errors }}
              {{ form.uid }}

              <label for="id_description">Beskrivelse:</label>
              {{ form.description.errors }}
              {{ form.description }}
            </fieldset>
            <fieldset class="span6">
              <label for="id_pcs">Computere i denne gruppe:</label>
              {{ form.pcs.errors }}
              {% include 'system/pclist/list.html' with submit_name='pcs' %}
            </fieldset>
          </div>
        </div>

        <div id="configs" class="tabcontent tab-pane fade" role="tabpanel" aria-labelledby="configs-tab">
          {% include 'system/configlist/list.html' with entries=selected_group.configuration.entries.all cnf_id='group_configuration' %}
        </div>

        <div id="policies" class="tabcontent tab-pane fade" role="tabpanel" aria-labelledby="policies-tab">
          {% include 'system/policy_list/list.html' with entries=selected_group.ordered_policy policy_id='group_policies' %}
        </div>
      </div>

    </form>

    <div id="addNewGroup" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <form action="{% url 'new_group' site.uid %}" name="new_group_form" id="new_group_form" method="post">
            <div class="modal-header">
              <h3 class="modal-title">Tilføj ny gruppe</h3>
              <button type="button" class="btn btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                {% csrf_token %}
                {{ newform.as_p }}
            </div>
            <div class="modal-footer">
              <input type="submit" class="btn btn-primary" value="Gem" />
              <input type="reset" class="btn" data-bs-dismiss="modal" value="Annuller" />
            </div>
          </form>
        </div>
      </div>
    </div>

    {% include 'system/configlist/templates.html' %}
    {% include 'system/policy_list/templates.html' with policy_id='group_policies' %}

  </div>
{% endblock %}
